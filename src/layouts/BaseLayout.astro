---
import Footer from "../components/Footer.astro";
import "../styles/global.css";


interface Props {
  title?: string;
  description?: string;
  path?: string;
  image?: string;
  index?: boolean;
  schema?: Record<string, unknown> | null;
}

// URL pública del sitio (puede venir por .env o quedar fija como fallback)
const siteUrl =
  import.meta.env.PUBLIC_SITE_URL ?? "https://cerrajeriamaresca.com.ar";

// Defaults SEO
const defaultTitle = "Cerrajería Maresca | Urgencias 24 horas en La Boca";
const defaultDescription =
  "Cerrajería Maresca: urgencias, reparaciones, aperturas de vehículos y puertas de cristal. Palos 721, Local 7, La Boca. Atención 24 horas.";

// Logo e imagen por defecto para OG / JSON-LD
const defaultImage = "/images/logo-oscuro.png";

const {
  title = defaultTitle,
  description = defaultDescription,
  path = (Astro.props as Props).path ?? Astro.url.pathname,
  image = defaultImage,
  index = (Astro.props as Props).index ?? true,
  schema = (Astro.props as Props).schema ?? null,
} = Astro.props as Props;

// SEO técnico
const canonicalUrl = new URL(path, siteUrl).toString();
const robotsContent = index ? "index,follow" : "noindex,nofollow";
const ogImage = image.startsWith("http")
  ? image
  : new URL(image, siteUrl).toString();

// Schema.org LocalBusiness por defecto
const defaultLocalBusinessSchema = {
  "@context": "https://schema.org",
  "@type": "Locksmith",
  name: "Cerrajería Maresca",
  image: ogImage,
  "@id": `${siteUrl}/#cerrajeria-maresca`,
  url: siteUrl,
  telephone: ["+54-11-4301-5204", "+54-11-6218-1863", "+54-11-3316-4381"],
  address: {
    "@type": "PostalAddress",
    streetAddress: "Palos 721, Local 7",
    addressLocality: "La Boca",
    addressRegion: "Ciudad Autónoma de Buenos Aires",
    postalCode: "C1162",
    addressCountry: "AR",
  },
  geo: {
    "@type": "GeoCoordinates",
    latitude: -34.634, // aproximado La Boca
    longitude: -58.36,
  },
  openingHoursSpecification: [
    {
      "@type": "OpeningHoursSpecification",
      dayOfWeek: [
        "Monday",
        "Tuesday",
        "Wednesday",
        "Thursday",
        "Friday",
        "Saturday",
        "Sunday",
      ],
      opens: "00:00",
      closes: "23:59",
    },
  ],
  areaServed: "Barrio de La Boca y zonas cercanas de CABA",
};

const jsonLd = JSON.stringify(schema ?? defaultLocalBusinessSchema);
---

<html lang="es-AR">
  <head>
    <meta charset="utf-8" />
    <title>{title}</title>
    <meta name="description" content={description} />

    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <link rel="icon" type="image/jpg" sizes="32x32" href="/images/logo-oscuro.jpg" />
<link rel="apple-touch-icon" href="/images/logo-oscuro.jpg" />

    <!-- Naranja Maresca como color del navegador -->
    <meta name="theme-color" content="#EA5529" />
    <meta name="robots" content={robotsContent} />
    <link rel="canonical" href={canonicalUrl} />

    <!-- Open Graph -->
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:type" content="website" />
    <meta property="og:locale" content="es_AR" />
    <meta property="og:site_name" content="Cerrajería Maresca" />
    <meta property="og:url" content={canonicalUrl} />
    <meta property="og:image" content={ogImage} />
    <meta
      property="og:image:alt"
      content="Cerrajería Maresca en La Boca, Ciudad de Buenos Aires"
    />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={ogImage} />

    <!-- JSON-LD negocio local -->
    <script type="application/ld+json" set:html={jsonLd}></script>
  </head>
  <body class="min-h-screen bg-[--color-bg-page] text-slate-900 antialiased ">
    <header
      class="border-b border-marine-700 bg-linear-to-r from-marine-700 via-marine-600 to-marine-700 text-white"
    >
      <div
        class="mx-auto flex max-w-6xl items-center justify-between px-4 py-3 md:py-4"
      >
        <div class="flex items-center gap-3">
          <!-- LOGO MÁS GRANDE EN EL HEADER -->
          <div
            class="flex h-16 w-16 items-center justify-center overflow-hidden rounded-xl bg-transparent shadow"
          >
            <img
              src="/images/logo-cm.png"
              alt="Logo de Cerrajería Maresca"
              class="h-16 w-16 object-contain"
              width="64"
              height="64"
              loading="lazy"
            />
          </div>
          <div>
            <p class="text-base font-semibold leading-tight">
              Cerrajería Maresca
            </p>
            <p class="text-xs text-white/80">
             Guardia / Urgencias en CABA
            </p>
          </div>
        </div>
        <div class="hidden text-right text-xs text-white/90 md:block">
          <p class="font-medium">Atención 24 horas</p>
          <p class="text-white/80">
            Tel: 11-6218-1863 · 11-3316-4381
          </p>
        </div>
      </div>
    </header>

    <main class="mx-auto max-w-6xl px-4 pb-16 pt-6 md:pt-10">
      <slot />
    </main>

 <Footer />
  </body>
</html>
